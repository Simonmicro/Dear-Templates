#
# Replace example.com with your domain
# 
<VirtualHost *:80>
# Server Name (a,aaaa,cname)
    ServerName example.com
# E.g. mail for 500 error       
    ServerAdmin webmaster@example.com
# NO HTTP, forward to HTTPS             
    Redirect permanent / https://example.com/
# Log stuff
    ErrorLog /var/log/apache2/example.com-http-error.log
    CustomLog /var/log/apache2/example.com-http-access.log common
</VirtualHost>

<VirtualHost *:443>
# Server Name (a,aaaa,cname)
    ServerName example.com
# E.g. mail for 500 error       
    ServerAdmin webmaster@example.com
# Where PHP and HTML is located (HTTPS)
    DocumentRoot /var/www/example.com
# ...or proxy everything from...
#    ProxyPass / http://localhost:19999/
#    ProxyPassReverse / http://localhost:19999/
# Use SSL + stuff
    SSLEngine on
# ...allow SSL on the proxy...
    SSLProxyEngine on
# ...to enforce the validity of the proxied server target...
    SSLProxyCheckPeerCN on
    SSLProxyCheckPeerExpire on
# The following in case no letsencrypt cert is there
    SSLCertificateFile /etc/ssl/certs/apache.crt
    SSLCertificateKeyFile /etc/ssl/private/apache.key
# ...and the lesencrypt version (check this with the certbot output)
#    SSLCertificateFile /etc/letsencrypt/live/example.com/fullchain.pem
#    SSLCertificateKeyFile /etc/letsencrypt/live/example.com/privkey.pem

# Log stuff
    ErrorLog /var/log/apache2/example.com-https-error.log
    CustomLog /var/log/apache2/example.com-https-access.log common

# To allow .htaccess in DocumentRoot
#    <Directory /var/www/example.com>
#        AllowOverride All
#    </Directory>

# Block access to any .git folder...
#    <Directorymatch "^/.*/\.git/">
#        Order deny,allow
#        Deny from all
#    </Directorymatch>

# To force htpasswd authentication
# The htpasswd file is created with "sudo htpasswd [-c (ONLY FOR FIRST USER)] /etc/htpasswd [INITIAL_USER]" --- MAKE SURE TO CHOWN THE FILE CORRECTLY!
# A user is added with "sudo htpasswd /etc/htpasswd [USER]"
# A user is deleted with "sudo htpasswd -D /etc/htpasswd [USER]"
#    <Location />
#        AuthType Basic
#        AuthName "Authentication Required"
#        AuthUserFile "/etc/htpasswd"
#        Require valid-user
#
#        Order allow,deny
#        Allow from all
#    </Location>

# To force LDAP authentication
#    <Location />
#        AuthType Basic
#        AuthBasicProvider ldap
#        AuthName "Authentication Required"
#        # Connect to the LDAP server anonymously...
#        AuthLDAPURL ldap://localhost:389/OU=[OU of users],DC=example,DC=com
#        # LDAP login requirements (s. documantation)...
#        AuthLDAPGroupAttribute memberUid
#        AuthLDAPGroupAttributeIsDN off
#        Require ldap-group CN=[required group],OU=[OU of groups],DC=example,DC=com
#    </Location>

# Following needed if lets-encrypt with active aith is wanted...
#    <Location /.well-known>
#        Require all granted
#    </Location>
#</VirtualHost>
